<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>E-Waste Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            transition: background 0.5s ease, color 0.5s ease;
        }
        .dark {
            background: linear-gradient(135deg, #1a202c, #2d3748);
            color: #e2e8f0;
        }
        #vanta-bg-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .content-wrapper {
            position: relative;
            z-index: 1;
        }

        /* --- Keyframe Animations --- */
        .animate-modal-popup {
            animation: slide-in-elliptic-top-fwd 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;
        }
        .animate-fade-in {
            animation: fade-in 0.6s ease-in-out both;
        }

        @keyframes slide-in-elliptic-top-fwd {
            0% {
                transform: translateY(-600px) rotateX(-30deg) scale(0);
                transform-origin: 50% 100%;
                opacity: 0;
            }
            100% {
                transform: translateY(0) rotateX(0) scale(1);
                transform-origin: 50% 1400px;
                opacity: 1;
            }
        }
        @keyframes fade-in {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-[#f0f4f8]">
    
    <div id="vanta-bg-container"></div>

    <div class="content-wrapper p-6">
        <div class="flex justify-between items-center mb-6">
              <h1 class="text-2xl font-bold text-white dark:text-white">üëã Welcome, User!</h1>
              <div class="flex gap-2">
                  <a href="index.html">
                       <button class="px-4 py-2 rounded-lg bg-pink-600 text-white hover:bg-pink-700 transition">üè† Home</button>
                  </a>
              </div>
       </div>
        
        <h2 class="bg-green-600 text-white px-4 py-2 rounded-lg shadow-md">‚öôÔ∏è E-Waste Calculator</h2>
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg mb-6 transition bg-opacity-80 dark:bg-opacity-80 backdrop-blur-sm">
            <label class="block font-medium">üìÇ Product Category</label>
            <select id="categorySelect" onchange="updateProducts()" 
               class="w-full mt-2 mb-4 p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-400 transition">
                 <option value="">Select category</option>
                 <option value="Large Appliances">Large Appliances</option>
                 <option value="Small Appliances">Small Appliances</option>
                 <option value="IT & Telecom">IT & Telecom</option>
                 <option value="Consumer Electronics">Consumer Electronics</option>
                 <option value="Lighting Equipment">Lighting Equipment</option>
                 <option value="Electrical Tools">Electrical Tools</option>
                 <option value="Toys">Toys</option>
                 <option value="Medical Devices">Medical Devices</option>
                 <option value="Monitoring Devices">Monitoring Devices</option>
                 <option value="Batteries & Cables">Batteries & Cables</option>
            </select>
        
            <label class="block font-medium">üì¶ Product Name</label>
            <input list="productList" id="productInput" oninput="updateWeight()" placeholder="Select or type product name"
               class="w-full mt-2 mb-4 p-3 rounded-lg border border-gray-300 dark:border-gray-600 
                      bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-400 transition">
            <datalist id="productList"></datalist>
        
            <label class="block font-medium">‚öñÔ∏è Weight of Product (kg)</label>
            <input type="number" id="weightInput" placeholder="Approx. weight will appear here" 
               min="1" max="999"
               class="w-full mt-2 p-3 rounded-lg border border-gray-300 dark:border-gray-600 
                      bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-400 transition">
            <p id="weightError" class="text-red-500 text-sm hidden">‚ùå Max 3 digits allowed (1-999).</p>
        
            <label class="block font-medium mt-4">üî¢ Quantity</label>
            <input type="number" id="quantityInput" placeholder="Enter quantity" value="1" min="1" max="999"
               class="w-full mt-2 p-3 rounded-lg border border-gray-300 dark:border-gray-600 
                      bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-400 transition">
            <p id="quantityError" class="text-red-500 text-sm hidden">‚ùå Max 3 digits allowed (1-999).</p>
        
            <button onclick="addProduct()" 
               class="mt-4 px-6 py-3 rounded-lg bg-pink-600 text-white hover:bg-pink-700 shadow-md transition">‚ûï Add</button>
       </div>
        
        <h2 class="bg-green-600 text-white px-4 py-2 rounded-lg shadow-md mt-8">üìä Calculation Table</h2>
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg transition overflow-x-auto bg-opacity-80 dark:bg-opacity-80 backdrop-blur-sm">
            <table class="w-full border-collapse text-center">
                  <thead>
                       <tr class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                           <th class="py-3 px-4 border">S.No</th>
                           <th class="py-3 px-4 border">Product Name</th>
                           <th class="py-3 px-4 border">Weight (kg)</th>
                           <th class="py-3 px-4 border">Quantity</th>
                           <th class="py-3 px-4 border">CO‚ÇÇ Saved (kg)</th>
                           </tr>
                  </thead>
                  <tbody id="productTable" class="divide-y divide-gray-200 dark:divide-gray-600"></tbody>
                  <tfoot>
                       <tr class="font-bold bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-gray-100">
                           <td colspan="2" class="py-3 px-4 border">Total</td>
                           <td id="totalWeight" class="py-3 px-4 border">0</td>
                           <td id="totalQty" class="py-3 px-4 border">0</td>
                           <td id="totalCO2" class="py-3 px-4 border">0</td>
                           </tr>
                  </tfoot>
            </table>
       </div>
    </div>
    
    <script>
        // ... Your existing calculator script remains unchanged ...
         const productOptions = { "Large Appliances": ["Refrigerator", "Washing Machine", "Air Conditioner"], "Small Appliances": ["Mixer", "Toaster", "Electric Kettle", "Iron Box"], "IT & Telecom": ["Laptop", "Desktop CPU", "Mobile Phone", "Tablet", "Printer"], "Consumer Electronics": ["Television", "CRT Monitor", "Set-top Box", "DVD Player"], "Lighting Equipment": ["LED Bulb", "Tube Light"], "Electrical Tools": ["Electric Drill", "Soldering Iron"], "Toys": ["Remote-Controlled Car", "Electronic Toy"], "Medical Devices": ["Glucometer", "Digital Thermometer"], "Monitoring Devices": ["CCTV Camera", "Door Alarm"], "Batteries & Cables": ["Power Bank", "USB Cable", "Charger"] };
         const averageWeights = { "Refrigerator": 70, "Washing Machine": 60, "Air Conditioner": 40, "Mixer": 3, "Toaster": 2, "Electric Kettle": 1, "Iron Box": 2, "Laptop": 2.5, "Desktop CPU": 8, "Mobile Phone": 0.2, "Tablet": 0.5, "Printer": 7, "Television": 15, "CRT Monitor": 12, "Set-top Box": 1, "DVD Player": 2, "LED Bulb": 0.1, "Tube Light": 0.3, "Electric Drill": 3, "Soldering Iron": 0.5, "Remote-Controlled Car": 1, "Electronic Toy": 0.5, "Glucometer": 0.2, "Digital Thermometer": 0.1, "CCTV Camera": 0.5, "Door Alarm": 0.3, "Power Bank": 0.4, "USB Cable": 0.1, "Charger": 0.2 };
         function updateProducts() { const category = document.getElementById("categorySelect").value; const productList = document.getElementById("productList"); document.getElementById("productInput").value = ""; document.getElementById("weightInput").value = ""; productList.innerHTML = ''; if (productOptions[category]) { productOptions[category].forEach(p => { const opt = document.createElement("option"); opt.value = p; productList.appendChild(opt); }); } }
         function updateWeight() { const product = document.getElementById("productInput").value; const weightInput = document.getElementById("weightInput"); if (averageWeights[product]) { weightInput.value = averageWeights[product]; } }
         function validateInput(inputId, errorId) { const input = document.getElementById(inputId); const error = document.getElementById(errorId); input.addEventListener("input", function () { if (this.value.length > 3) { this.value = this.value.slice(0, 3); error.classList.remove("hidden"); } else { error.classList.add("hidden"); } }); }
         validateInput("weightInput", "weightError"); validateInput("quantityInput", "quantityError");
         let row = 0, totalQty = 0, totalWeight = 0, totalCO2 = 0;
         function addProduct() { const category = document.getElementById("categorySelect").value; const product = document.getElementById("productInput").value.trim(); const weight = parseFloat(document.getElementById("weightInput").value); const quantity = parseInt(document.getElementById("quantityInput").value); if (!category || !product || isNaN(weight) || weight <= 0 || isNaN(quantity) || quantity < 1) { return alert("Please fill all fields with valid data."); } const totalProdWeight = weight * quantity; const co2 = totalProdWeight * 1.2; row++; totalQty += quantity; totalWeight += totalProdWeight; totalCO2 += co2; const tr = document.createElement("tr"); tr.className = "hover:bg-gray-100 dark:hover:bg-gray-700 transition"; tr.innerHTML = ` <td class="py-2 px-4 border">${row}</td> <td class="py-2 px-4 border">${product} <br><small class="text-gray-500 dark:text-gray-400">(${category})</small></td> <td class="py-2 px-4 border">${totalProdWeight.toFixed(1)}</td> <td class="py-2 px-4 border">${quantity}</td> <td class="py-2 px-4 border">${co2.toFixed(1)}</td>`; document.getElementById("productTable").appendChild(tr); document.getElementById("totalQty").textContent = totalQty; document.getElementById("totalWeight").textContent = totalWeight.toFixed(1); document.getElementById("totalCO2").textContent = totalCO2.toFixed(1); document.getElementById("categorySelect").value = ""; document.getElementById("productList").innerHTML = ""; document.getElementById("productInput").value = ""; document.getElementById("weightInput").value = ""; document.getElementById("quantityInput").value = "1"; document.getElementById("weightError").classList.add("hidden"); document.getElementById("quantityError").classList.add("hidden"); }
    </script>

    <button id="chat-icon-button" class="fixed bottom-5 right-5 w-16 h-16 bg-pink-600 rounded-full shadow-lg flex items-center justify-center text-white hover:bg-pink-700 transition-colors z-50">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/></svg>
    </button>
    <div id="chat-widget-container" class="hidden fixed bottom-24 right-5 w-full max-w-md mx-auto bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col h-[70vh] z-40">
        <div class="flex flex-col flex-grow overflow-hidden">
               <div class="w-full flex flex-col h-full overflow-hidden">
                    <div class="bg-green-600 text-white p-4 flex items-center justify-between"><h1 class="text-xl font-bold">Website Assistant</h1><button id="close-chat-button" class="text-white hover:bg-green-700 rounded-full p-1"><svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></button></div>
                    <div id="chat-messages" class="flex-grow p-4 overflow-y-auto space-y-4 bg-gray-100"><div class="flex items-start"><div class="flex-shrink-0 w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white font-bold text-sm">AI</div><div class="ml-3 bg-white p-3 rounded-xl max-w-[80%] shadow-sm"><p class="text-sm text-gray-800">Hello! I am your assistant. How can I help you today?</p></div></div></div>
                    <div class="p-4 bg-gray-50 border-t border-gray-200"><div class="flex items-center justify-center mb-2"><button id="summary-button" class="summary-btn">‚ú® Summarize Conversation ‚ú®</button></div><div class="flex items-center space-x-2"><input id="user-input" type="text" placeholder="Type your message..." class="flex-grow p-3 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"><button id="send-button" class="bg-green-600 text-white p-3 rounded-full hover:bg-green-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M3.478 2.405a.75.75 0 0 0-.926.94l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.981.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.405Z" /></svg></button></div></div>
               </div>
        </div>
    </div>
    
    <div id="celebration-overlay" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 transition-opacity duration-300 p-4">
        <div id="celebration-modal" class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-sm text-center p-8">
            <div class="w-24 h-24 text-yellow-400 mx-auto animate-fade-in" style="animation-delay: 0.1s;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.963 2.286a.75.75 0 00-1.071 1.071L12.75 5.25H11.25a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H12.75v-.828l1.038-1.038A.75.75 0 0012.963 2.286zM9.75 5.25a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM12 7.5a.75.75 0 01.75.75v12a.75.75 0 01-1.5 0v-12A.75.75 0 0112 7.5zM15.43 4.93a.75.75 0 001.07-1.07l-1.06-1.06a.75.75 0 00-1.07 1.07l1.06 1.06zM17.25 7.5a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5h1.5zM8.57 3.86a.75.75 0 00-1.07-1.07l-1.06 1.06a.75.75 0 001.07 1.07l1.06-1.06zM6.75 7.5a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5h1.5z" clip-rule="evenodd" />
                    <path d="M5.25 21a.75.75 0 01.75-.75h12a.75.75 0 010 1.5H6a.75.75 0 01-.75-.75z" />
                </svg>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 dark:text-white mt-4 animate-fade-in" style="animation-delay: 0.3s;">Achievement Unlocked!</h3>
            <p class="text-gray-600 dark:text-gray-300 my-4 animate-fade-in" style="animation-delay: 0.5s;">You're an Eco-Star! Thanks for making a positive impact. Let's see the results of your awesome contribution.</p>
            <button id="close-modal-button" class="w-full mt-4 px-4 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition animate-fade-in" style="animation-delay: 0.7s;">Let's Go!</button>
        </div>
    </div>

    <script src="chatgpt.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script>
         document.addEventListener('DOMContentLoaded', () => {
              VANTA.NET({
                  el: "#vanta-bg-container", mouseControls: true, touchControls: true, gyroControls: false, minHeight: 200.00, minWidth: 200.00, scale: 1.00, scaleMobile: 1.00, color: 0x22c55e, backgroundColor: 0x424b0b, points: 12.00, maxDistance: 23.00, spacing: 18.00
              });
             
              if (typeof initializeChatbot === 'function') { initializeChatbot(); }

              // --- New Party "Fireworks" Celebration Logic ---
              const celebrationOverlay = document.getElementById('celebration-overlay');
              const celebrationModal = document.getElementById('celebration-modal');
              const closeModalButton = document.getElementById('close-modal-button');

              function randomInRange(min, max) {
                  return Math.random() * (max - min) + min;
              }

              // MODIFIED: New, "party-style" fireworks celebration
              function startCelebration() {
                  const duration = 2 * 1000; // 2 seconds
                  const animationEnd = Date.now() + duration;
                  const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 1000 };

                  const interval = setInterval(function() {
                      const timeLeft = animationEnd - Date.now();

                      if (timeLeft <= 0) {
                          return clearInterval(interval);
                      }

                      const particleCount = 50 * (timeLeft / duration);
                      // since particles fall down, start a bit higher than random
                      confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } });
                      confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } });
                  }, 250);
              }

              function showModal() {
                  celebrationOverlay.classList.remove('hidden');
                  setTimeout(() => {
                      celebrationModal.classList.add('animate-modal-popup');
                      celebrationOverlay.style.opacity = '1';
                      startCelebration();
                  }, 50);
              }

              function hideModal() {
                  celebrationOverlay.style.opacity = '0';
                  celebrationModal.classList.remove('animate-modal-popup');
                  setTimeout(() => {
                      celebrationOverlay.classList.add('hidden');
                  }, 300);
              }

              showModal();
              
              closeModalButton.addEventListener('click', hideModal);
              celebrationOverlay.addEventListener('click', (event) => {
                  if (event.target === celebrationOverlay) {
                      hideModal();
                  }
              });
         });
    </script>
</body>
</html>